<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ShantiIA</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    background-color: #e5e5e5; /* Fondo general */
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    padding: 20px;
}

.chat-wrapper {
    max-width: 420px;
    width: 100%;
    height: 90%;
    background-color: #f5f5f5;
    border-radius: 15px;
    box-shadow: 0px 4px 15px rgba(0, 0, 0, 0.2);
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
}

.chat-container {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.chat-header {
    background-color: #25D366; 
    color: white;
    padding: 15px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.chat-header img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    margin-right: 10px;
}

.chat-box {
    flex-grow: 1;
    padding: 15px;
    background-color: #f2f2f2;
    overflow-y: auto; /* Desplazamiento automático */
    border-bottom: 1px solid #ddd;
    border-radius: 10px;
    margin-bottom: 15px;
    transition: all 0.3s ease;
}

.chat-input {
    display: flex;
    padding: 10px;
    background-color: #e5e5e5;
}

.chat-input input {
    width: 80%;
    padding: 10px;
    border: none;
    border-radius: 20px;
    margin-right: 10px;
    font-size: 14px;
}

.chat-input button {
    background-color: #25D366;
    color: white;
    padding: 10px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.chat-input button:hover {
    background-color: #128C7E;
}

.suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 10px;
    margin-bottom: 15px;
    display: none; /* Se mostrará solo después de la primera interacción */
}

.suggestion-btn {
    background-color: #25D366;
    color: white;
    border: none;
    border-radius: 25px;
    padding: 8px 15px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
}

.suggestion-btn:hover {
    background-color: #128C7E;
    transform: scale(1.05);
}

.suggestion-btn:active {
    opacity: 0.7;
}

.user-message, .bot-message {
    margin-bottom: 15px;
    padding: 10px;
    border-radius: 20px;
    max-width: 80%;
    font-size: 14px;
    transition: all 0.3s ease;
}

.user-message {
    background-color: #dcf8c6;
    align-self: flex-end;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.bot-message {
    background-color: #ffffff;
    border: 1px solid #e1e1e1;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.chat-box::-webkit-scrollbar {
    width: 6px;
}

.chat-box::-webkit-scrollbar-thumb {
    background-color: #25D366;
    border-radius: 10px;
}

.chat-box::-webkit-scrollbar-thumb:hover {
    background-color: #128C7E;
}
</style>
</head>
<body>

<div class="chat-wrapper">
  <div class="chat-container">
    <div class="chat-header">
      <img src="/image.png" alt="Chatbot Logo" />
      <h2>ShantiIA</h2>
    </div>

    <div id="messages" class="chat-box"></div>

    <div id="suggestions" class="suggestions"></div>

    <div class="chat-input">
      <input type="text" id="userInput" placeholder="Escribe tu mensaje aquí..." autocomplete="off" />
      <button onclick="sendMessage()">Enviar</button>
    </div>
  </div>
</div>
<style>
    #music-controls {
  position: fixed;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 10px;
  background: rgba(255, 255, 255, 0.1);
  padding: 10px 15px;
  border-radius: 15px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  z-index: 999;
}

#music-controls button {
  background-color: #25D366;
  color: white;
  border: none;
  padding: 10px 14px;
  font-size: 18px;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

#music-controls button:hover {
  background-color: #128C7E;
  transform: scale(1.05);
}

</style>

<!-- CONTINUACIÓN DEL CÓDIGO: agregar música de fondo con controles en la esquina -->
<audio id="bgMusic" loop>
  <source src="/Ecos de Paz.mp3" type="audio/mpeg">
  Tu navegador no soporta audio HTML5.
</audio>

<div id="music-controls" style="position: fixed; bottom: 20px; right: 20px; background: #fff; border: 1px solid #ccc; border-radius: 15px; padding: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.15); z-index: 1000; display: flex; align-items: center; gap: 10px;">
  <button onclick="toggleMusic()" style="cursor:pointer;">Play/Pause</button>
  <button onclick="restartMusic()" style="cursor:pointer;">Reiniciar</button>
  <input type="range" id="progressBar" value="0" step="1" style="width: 100px;" />
</div>

<script>
const music = document.getElementById("bgMusic");
const progressBar = document.getElementById("progressBar");
let musicInterval;

function toggleMusic() {
  if (music.paused) {
    music.play();
    musicInterval = setInterval(updateProgressBar, 500);
  } else {
    music.pause();
    clearInterval(musicInterval);
  }
}

function restartMusic() {
  music.currentTime = 0;
  music.play();
  musicInterval = setInterval(updateProgressBar, 500);
}

function updateProgressBar() {
  if (music.duration) {
    progressBar.max = Math.floor(music.duration);
    progressBar.value = Math.floor(music.currentTime);
  }
}

progressBar.addEventListener("input", () => {
  music.currentTime = progressBar.value;
});
</script>

<script>
const knowledgeBase = [
    {
        keywords: ["cultura", "paz"],
        responses: {
            es: [
                "La cultura de paz promueve el respeto, la tolerancia y la convivencia sin violencia.",
                "Es una forma de vida basada en valores como la empatía y la resolución de conflictos."
            ],
            en: [
                "A culture of peace promotes respect, tolerance, and non-violent coexistence.",
                "It's a way of life based on empathy and peaceful conflict resolution."
            ],
            fr: [
                "La culture de la paix promeut le respect, la tolérance et la coexistence pacifique.",
                "C’est un mode de vie basé sur l’empathie et la résolution pacifique des conflits."
            ],
            pt: [
                "A cultura de paz promove o respeito, a tolerância e a convivência sem violência.",
                "É um estilo de vida baseado na empatia e na resolução pacífica de conflitos."
            ]
        }
    },
    {
        keywords: ["derechos", "humanos"],
        responses: {
            es: [
                "Los derechos humanos garantizan la dignidad de todas las personas.",
                "Son principios universales para vivir con libertad e igualdad."
            ],
            en: [
                "Human rights guarantee dignity for all people.",
                "They are universal principles for living in freedom and equality."
            ],
            fr: [
                "Les droits de l'homme garantissent la dignité de toutes les personnes.",
                "Ce sont des principes universels pour vivre dans la liberté et l'égalité."
            ],
            pt: [
                "Os direitos humanos garantem a dignidade de todas as pessoas.",
                "São princípios universais para viver com liberdade e igualdade."
            ]
        }
    },
    {
        keywords: ["hola", "hello", "salut", "olá", "buenas", "hi", "bonjour", "bom dia", "hey", "qué tal", "pura vida", "ça va", "tudo bem"],
        responses: {
            es: ["¡Hola! ¿En qué puedo ayudarte hoy?", "¡Pura vida! ¿Querés hablar sobre la paz o algo más?"],
            en: ["Hey there! How can I help you today?", "Hello! Ready to chat about peace or anything else?"],
            fr: ["Salut ! Comment puis-je t'aider aujourd'hui ?", "Bonjour ! On parle de paix ou autre chose ?"],
            pt: ["Oi! Como posso te ajudar hoje?", "Olá! Vamos conversar sobre paz ou outro tema?"]
        }
    },
    {
        keywords: ["conflicto", "resolver", "violencia"],
        responses: {
            es: [
                "Los conflictos se resuelven mejor hablando y escuchando.",
                "Evitar la violencia es clave para una convivencia sana."
            ],
            en: [
                "Conflicts are best resolved through communication and listening.",
                "Avoiding violence is key to healthy coexistence."
            ],
            fr: [
                "Les conflits se résolvent mieux par la communication et l'écoute.",
                "Éviter la violence est essentiel pour une coexistence saine."
            ],
            pt: [
                "Conflitos se resolvem melhor com diálogo e escuta.",
                "Evitar a violência é fundamental para uma convivência saudável."
            ]
        }
    },
    // Agrega más temas y respuestas aquí
    {
        keywords: ["ortografía", "errores", "signos", "gramática"],
        responses: {
            es: [
                "Es importante usar los signos de puntuación correctamente para dar claridad al mensaje.",
                "Evitar las faltas de ortografía mejora la comunicación escrita y da buena impresión."
            ],
            en: [
                "Using punctuation correctly is essential for clear communication.",
                "Avoiding spelling mistakes improves written communication and creates a good impression."
            ],
            fr: [
                "Il est important d'utiliser correctement la ponctuation pour clarifier le message.",
                "Éviter les fautes d'orthographe améliore la communication écrite et donne une bonne impression."
            ],
            pt: [
                "É importante usar a pontuação corretamente para clareza na mensagem.",
                "Evitar erros de ortografia melhora a comunicação escrita e causa boa impressão."
            ]
        }
    },
    {
        keywords: ["saludos", "saludo", "hola", "buenos días", "buenas tardes", "buenas noches"],
        responses: {
            es: [
                "¡Buenos días! ¿Cómo estás?",
                "¡Buenas tardes! ¿En qué puedo ayudarte?",
                "¡Buenas noches! Espero que tengas un buen descanso."
            ],
            en: [
                "Good morning! How are you?",
                "Good afternoon! How can I help you?",
                "Good evening! Hope you have a restful night."
            ],
            fr: [
                "Bonjour! Comment ça va?",
                "Bon après-midi! Comment puis-je vous aider?",
                "Bonsoir! J'espère que vous passerez une bonne nuit."
            ],
            pt: [
                "Bom dia! Como você está?",
                "Boa tarde! Como posso te ajudar?",
                "Boa noite! Espero que tenha uma boa noite de descanso."
            ]
        }
    },
    {
        keywords: ["consejos", "recomendaciones", "vida", "salud"],
        responses: {
            es: [
                "Recuerda beber suficiente agua durante el día para mantenerte hidratado.",
                "Dormir al menos 7-8 horas mejora tu salud física y mental."
            ],
            en: [
                "Remember to drink enough water throughout the day to stay hydrated.",
                "Sleeping at least 7-8 hours improves your physical and mental health."
            ],
            fr: [
                "N'oubliez pas de boire suffisamment d'eau pendant la journée pour rester hydraté.",
                "Dormir au moins 7-8 heures améliore votre santé physique et mentale."
            ],
            pt: [
                "Lembre-se de beber bastante água durante o dia para se manter hidratado.",
                "Dormir pelo menos 7-8 horas melhora sua saúde física e mental."
            ]
        }
    }
];

const allQuestions = [
    "¿Qué es la cultura de paz?",
    "What are human rights?",
    "Comment résoudre un conflit sans violence?",
    "Como promover a paz na escola?",
    "¿Qué significa respeto?",
    "How to prevent bullying?",
    "O que é paz positiva?",
    "Salut !",
    "Hola, ¿cómo estás?",
    "Hi there!",
    "Bom dia!",
    "¿Por qué es importante la ortografía?",
    "What are common punctuation mistakes?",
    "Donnez-moi des conseils pour une vie saludable",
    "Como puedo mejorar mi gramática?",
    "Saluda en francés, por favor",
    "Recomiéndame consejos para la salud",
    "¿Cómo evitar conflictos violentos?",
    "How do you say hello in Portuguese?"
];

const soundIncomingMessage = new Audio("incoming-message.mp3");
const soundOutgoingMessage = new Audio("outgoing-message.mp3");

function normalize(text) {
    return text
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/[^\w\s]/gi, "")
        .replace(/\s+/g, " ")
        .trim();
}

function detectLanguage(message) {
    if (/¿|qué|paz|hola|buenas|derechos|resolver|conflicto|ortografia|saludos|consejos/.test(message)) return "es";
    if (/what|how|hi|hello|peace|rights|punctuation|recommendations/.test(message)) return "en";
    if (/comment|bonjour|salut|droits|paix|ça va|conseils/.test(message)) return "fr";
    if (/como|olá|bom dia|paz|direitos|resolver|saude/.test(message)) return "pt";
    return "es";
}

function getResponse(message) {
    const normalized = normalize(message);
    const lang = detectLanguage(message);

    for (const entry of knowledgeBase) {
        const matches = entry.keywords.some(kw => normalized.includes(kw));
        if (matches) {
            const options = entry.responses[lang] || entry.responses["es"];
            return options[Math.floor(Math.random() * options.length)];
        }
    }

    return {
        es: "No entendí muy bien tu pregunta, ¿podés repetirla?",
        en: "Sorry, I didn’t quite get that. Could you rephrase?",
        fr: "Désolé, je n'ai pas bien compris. Peux-tu reformuler ?",
        pt: "Desculpa, não entendi bem. Pode repetir a pergunta?"
    }[lang];
}

function addMessage(text, className) {
    const message = document.createElement("div");
    message.classList.add(className);
    message.innerText = text;
    const messagesContainer = document.getElementById("messages");
    messagesContainer.appendChild(message);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

function sendMessage() {
    const userInput = document.getElementById("userInput");
    const message = userInput.value.trim();
    if (!message) return;

    addMessage(message, "user-message");
    soundOutgoingMessage.play();

    userInput.value = "";
    userInput.focus();
    hideSuggestions();

    setTimeout(() => {
        const response = getResponse(message);
        addMessage(response, "bot-message");
        soundIncomingMessage.play();
        displaySuggestions();
    }, 800);
}

function sendSuggestion(suggestion) {
    addMessage(suggestion, "user-message");
    soundOutgoingMessage.play();
    hideSuggestions();

    setTimeout(() => {
        const response = getResponse(suggestion);
        addMessage(response, "bot-message");
        soundIncomingMessage.play();
        displaySuggestions();
    }, 800);
}

function displaySuggestions() {
    const suggestionsContainer = document.getElementById("suggestions");
    suggestionsContainer.innerHTML = "";

    const randomQuestions = [];
    while (randomQuestions.length < 3) {
        const rand = allQuestions[Math.floor(Math.random() * allQuestions.length)];
        if (!randomQuestions.includes(rand)) randomQuestions.push(rand);
    }

    randomQuestions.forEach(question => {
        const button = document.createElement("button");
        button.classList.add("suggestion-btn");
        button.innerText = question;
        button.onclick = () => sendSuggestion(question);
        suggestionsContainer.appendChild(button);
    });

    suggestionsContainer.style.display = "flex";
}

function hideSuggestions() {
    const suggestionsContainer = document.getElementById("suggestions");
    suggestionsContainer.style.display = "none";
}

window.onload = () => {
    displaySuggestions();
    const userInput = document.getElementById("userInput");
    userInput.focus();

    userInput.addEventListener("keydown", function (e) {
        if (e.key === "Enter") {
            e.preventDefault();
            sendMessage();
        }
    });
};
</script>

</body>
</html>
